<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NJ Alimony & Child Support Estimator</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .slider-label {
      font-weight: 500;
    }
    .result-box {
      font-size: 1.25rem;
      font-weight: bold;
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <div class="container py-5">
    <h1 class="mb-4 text-center">NJ Alimony & Child Support Estimator</h1>

    <div class="mb-4">
      <label for="spouse1Income" class="form-label slider-label">Spouse 1 Annual Income: $<span id="spouse1IncomeLabel">100000</span></label>
      <input type="number" class="form-control mb-1" id="spouse1IncomeInput" value="100000" min="0" max="500000">
      <input type="range" class="form-range" min="0" max="500000" step="1000" id="spouse1Income" value="100000">
    </div>

    <div class="mb-4">
      <label for="spouse2Income" class="form-label slider-label">Spouse 2 Annual Income: $<span id="spouse2IncomeLabel">50000</span></label>
      <input type="number" class="form-control mb-1" id="spouse2IncomeInput" value="50000" min="0" max="500000">
      <input type="range" class="form-range" min="0" max="500000" step="1000" id="spouse2Income" value="50000">
    </div>

    <div class="mb-4">
      <label for="numChildren" class="form-label slider-label">Number of Children</label>
      <select class="form-select" id="numChildren">
        <option value="0">0</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
      </select>
    </div>

    <div id="childAges" class="mb-4"></div>

    <div class="mb-4">
      <label for="marriageLength" class="form-label slider-label">Length of Marriage (years)</label>
      <input type="number" class="form-control" id="marriageLength" value="10" min="0">
    </div>

    <div class="mb-4">
      <label for="separationLength" class="form-label slider-label">Length of Separation (years)</label>
      <input type="number" class="form-control" id="separationLength" value="1" min="0">
    </div>

    <div class="mb-4">
      <label for="parentingTime" class="form-label slider-label">Parenting Time with Spouse 1 (%): <span id="parentingTimeLabel">50</span>% (<span id="overnightsSpouse1">182.5</span> overnights)</label>
      <input type="range" class="form-range" min="0" max="100" step="1" id="parentingTime" value="50">
      <div class="form-text">Parenting Time with Spouse 2: <span id="spouse2TimeLabel">50</span>% (<span id="overnightsSpouse2">182.5</span> overnights)</div>
    </div>

    <div class="card">
      <div class="card-body">
        <p class="result-box text-center">Estimated Alimony Paid by Higher Earner: $<span id="alimonyAmount">0</span>/year</p>
        <p class="result-box text-center">Estimated Child Support (Paid by Lower Earner if Less Parenting Time): $<span id="childSupportAmount">0</span>/year ($<span id="childSupportMonthly">0</span>/mo)</p>
        <div class="result-box">
          <p class="text-center">Estimated Total Child Support Per Child Until Age 20:</p>
          <ul id="perChildSupport" class="list-group list-group-flush text-center"></ul>
        </div>
        <p class="result-box text-center">Combined Total Child Support: $<span id="childSupportTotal">0</span> over <span id="childSupportTotalYears">0</span> years</p>
        <p class="result-box text-center">Total Combined Support: $<span id="totalSupportYearly">0</span>/year ($<span id="totalSupportMonthly">0</span>/mo)</p>
        <p class="result-box text-center">Estimated Alimony Duration: <span id="alimonyDuration">0</span> years â€” Total: $<span id="alimonyTotal">0</span></p>
        <p class="text-muted text-center">* Based on simplified NJ model and norms, not legal advice.</p>
      </div>
    </div>
  </div>

  <script>
    const spouse1Slider = document.getElementById('spouse1Income');
    const spouse1Input = document.getElementById('spouse1IncomeInput');
    const spouse2Slider = document.getElementById('spouse2Income');
    const spouse2Input = document.getElementById('spouse2IncomeInput');
    const numChildren = document.getElementById('numChildren');
    const parentingTime = document.getElementById('parentingTime');
    const marriageLength = document.getElementById('marriageLength');
    const separationLength = document.getElementById('separationLength');

    const spouse1Label = document.getElementById('spouse1IncomeLabel');
    const spouse2Label = document.getElementById('spouse2IncomeLabel');
    const parentingTimeLabel = document.getElementById('parentingTimeLabel');
    const spouse2TimeLabel = document.getElementById('spouse2TimeLabel');
    const overnightsSpouse1 = document.getElementById('overnightsSpouse1');
    const overnightsSpouse2 = document.getElementById('overnightsSpouse2');

    const alimonyAmount = document.getElementById('alimonyAmount');
    const childSupportAmount = document.getElementById('childSupportAmount');
    const childSupportMonthly = document.getElementById('childSupportMonthly');
    const totalSupportYearly = document.getElementById('totalSupportYearly');
    const totalSupportMonthly = document.getElementById('totalSupportMonthly');
    const alimonyDuration = document.getElementById('alimonyDuration');
    const alimonyTotal = document.getElementById('alimonyTotal');
    const childSupportTotal = document.getElementById('childSupportTotal');
    const childSupportTotalYears = document.getElementById('childSupportTotalYears');
    const perChildSupportList = document.getElementById('perChildSupport');

    const childAgesDiv = document.getElementById('childAges');

    function syncSliders() {
      spouse1Input.addEventListener('input', () => {
        spouse1Slider.value = spouse1Input.value;
        calculateSupport();
      });
      spouse1Slider.addEventListener('input', () => {
        spouse1Input.value = spouse1Slider.value;
        calculateSupport();
      });
      spouse2Input.addEventListener('input', () => {
        spouse2Slider.value = spouse2Input.value;
        calculateSupport();
      });
      spouse2Slider.addEventListener('input', () => {
        spouse2Input.value = spouse2Slider.value;
        calculateSupport();
      });
    }

    function updateChildAgeInputs() {
      childAgesDiv.innerHTML = '';
      const count = parseInt(numChildren.value);
      for (let i = 0; i < count; i++) {
        const input = document.createElement('input');
        input.type = 'number';
        input.min = '0';
        input.max = '20';
        input.className = 'form-control my-1';
        input.placeholder = `Age of Child ${i + 1}`;
        input.id = `childAge${i}`;
        childAgesDiv.appendChild(input);
      }
    }

    function calculateSupport() {
      const income1 = parseInt(spouse1Slider.value);
      const income2 = parseInt(spouse2Slider.value);
      const children = parseInt(numChildren.value);
      const time1 = parseInt(parentingTime.value);
      const time2 = 100 - time1;
      const yearsMarried = parseInt(marriageLength.value);
      const yearsSeparated = parseInt(separationLength.value);

      const nights1 = (time1 / 100) * 365;
      const nights2 = 365 - nights1;

      const higherIncome = Math.max(income1, income2);
      const lowerIncome = Math.min(income1, income2);
      let alimony = 0;
      if (higherIncome > lowerIncome) {
        alimony = (higherIncome - lowerIncome) * 0.25;
      }

      let childSupport = 0;
      if (children > 0) {
        const totalIncome = income1 + income2;
        const baseChildCost = 17000 * children;

        const lowerIncomeParent = income1 < income2 ? 1 : 2;
        const lowerParentTime = lowerIncomeParent === 1 ? time1 : time2;

        if (lowerParentTime < 50) {
          const lowerIncomeShare = (lowerIncome / totalIncome);
          childSupport = baseChildCost * lowerIncomeShare * ((50 - lowerParentTime) / 50);
        }
      }

      let alimonyYears = 0;
      if (yearsMarried < 20) {
        alimonyYears = Math.floor(yearsMarried / 2);
      } else {
        alimonyYears = 20;
      }

      const alimonyTotalValue = alimony * alimonyYears;

      let childSupportDuration = 0;
      let perChildSupport = [];
      for (let i = 0; i < children; i++) {
        const ageInput = document.getElementById(`childAge${i}`);
        const age = parseInt(ageInput?.value || '0');
        const yearsLeft = age < 20 ? 20 - age : 0;
        childSupportDuration += yearsLeft;
        perChildSupport.push({ child: i + 1, years: yearsLeft, total: Math.round((childSupport / children) * yearsLeft) });
      }

      const totalChildSupport = childSupport * childSupportDuration / (children || 1);

      const totalYearly = alimony + childSupport;
      const totalMonthly = totalYearly / 12;

      spouse1Label.textContent = income1.toLocaleString();
      spouse2Label.textContent = income2.toLocaleString();
      parentingTimeLabel.textContent = time1;
      spouse2TimeLabel.textContent = `${time2} %`;
      overnightsSpouse1.textContent = nights1.toFixed(1);
      overnightsSpouse2.textContent = nights2.toFixed(1);

      alimonyAmount.textContent = Math.round(alimony).toLocaleString();
      childSupportAmount.textContent = Math.round(childSupport).toLocaleString();
      childSupportMonthly.textContent = Math.round(childSupport / 12).toLocaleString();
      totalSupportYearly.textContent = Math.round(totalYearly).toLocaleString();
      totalSupportMonthly.textContent = Math.round(totalMonthly).toLocaleString();
      alimonyDuration.textContent = alimonyYears;
      alimonyTotal.textContent = Math.round(alimonyTotalValue).toLocaleString();
      childSupportTotal.textContent = Math.round(totalChildSupport).toLocaleString();
      childSupportTotalYears.textContent = Math.round(childSupportDuration / (children || 1));

      perChildSupportList.innerHTML = '';
      perChildSupport.forEach(c => {
        const li = document.createElement('li');
        li.className = 'list-group-item';
        li.textContent = `Child ${c.child}: $${c.total.toLocaleString()} over ${c.years} years`;
        perChildSupportList.appendChild(li);
      });
    }

    syncSliders();
    spouse1Slider.addEventListener('input', calculateSupport);
    spouse2Slider.addEventListener('input', calculateSupport);
    numChildren.addEventListener('change', () => {
      updateChildAgeInputs();
      calculateSupport();
    });
    parentingTime.addEventListener('input', calculateSupport);
    marriageLength.addEventListener('input', calculateSupport);
    separationLength.addEventListener('input', calculateSupport);
    childAgesDiv.addEventListener('input', calculateSupport);

    updateChildAgeInputs();
    calculateSupport();
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
